┌─────────────────────────────────────┐
│  X = Channel×Time Matrix            │
├─────────────────────────────────────┤
│     t₁   t₂   t₃   t₄               │
│ Ch1 [ 2    4   -1    3  ]           │
│ Ch2 [-1    3    2   -2  ]           │
│ Ch3 [ 3   -2    1    4  ]           │
└─────────────────────────────────────┘
```

---

## PART 1: TEMPORAL FEATURE EXTRACTION MODULE (TFEM)

### TFEM Operation: 1D Convolution Along Time

**Convolution Kernel** (size 1×2):
```
K = [0.5, -0.3]
```

**Stride** = 1, **No padding**

### Channel 1 Convolution:

**Input**: [2, 4, -1, 3]

**Position 1**: 
```
Window: [2, 4]
Output₁ = (2 × 0.5) + (4 × -0.3) = 1.0 - 1.2 = -0.2
```

**Position 2**:
```
Window: [4, -1]
Output₂ = (4 × 0.5) + (-1 × -0.3) = 2.0 + 0.3 = 2.3
```

**Position 3**:
```
Window: [-1, 3]
Output₃ = (-1 × 0.5) + (3 × -0.3) = -0.5 - 0.9 = -1.4
```

**Channel 1 After TFEM**: [-0.2, 2.3, -1.4]

---

### Channel 2 Convolution:

**Input**: [-1, 3, 2, -2]

**Position 1**:
```
Window: [-1, 3]
Output₁ = (-1 × 0.5) + (3 × -0.3) = -0.5 - 0.9 = -1.4
```

**Position 2**:
```
Window: [3, 2]
Output₂ = (3 × 0.5) + (2 × -0.3) = 1.5 - 0.6 = 0.9
```

**Position 3**:
```
Window: [2, -2]
Output₃ = (2 × 0.5) + (-2 × -0.3) = 1.0 + 0.6 = 1.6
```

**Channel 2 After TFEM**: [-1.4, 0.9, 1.6]

---

### Channel 3 Convolution:

**Input**: [3, -2, 1, 4]

**Position 1**:
```
Window: [3, -2]
Output₁ = (3 × 0.5) + (-2 × -0.3) = 1.5 + 0.6 = 2.1
```

**Position 2**:
```
Window: [-2, 1]
Output₂ = (-2 × 0.5) + (1 × -0.3) = -1.0 - 0.3 = -1.3
```

**Position 3**:
```
Window: [1, 4]
Output₃ = (1 × 0.5) + (4 × -0.3) = 0.5 - 1.2 = -0.7
```

**Channel 3 After TFEM**: [2.1, -1.3, -0.7]

---

### TFEM Output Summary:
```
┌──────────────────────────────────────┐
│  X_tfem = After Temporal Convolution │
├──────────────────────────────────────┤
│       t₁'   t₂'   t₃'                │
│ Ch1 [-0.2   2.3  -1.4]               │
│ Ch2 [-1.4   0.9   1.6]               │
│ Ch3 [ 2.1  -1.3  -0.7]               │
└──────────────────────────────────────┘
```

**New dimensions**: 3 channels × 3 time points

---

## PART 2: CHANNEL ACTIVE REASONING MODULE (CARM)

### Step 1: Initialize Adjacency Matrix W*

**Rule**: Connect all channels except self-connections
```
┌─────────────────────────────────┐
│  W* (Initial Adjacency Matrix)  │
├─────────────────────────────────┤
│        Ch1  Ch2  Ch3             │
│  Ch1 [  0    1    1  ]           │
│  Ch2 [  1    0    1  ]           │
│  Ch3 [  1    1    0  ]           │
└─────────────────────────────────┘
```

---

### Step 2: Add Self-Connections
```
W̃ = W* + I₃

┌──────────────────────────────────┐
│  W̃ = W* + Identity               │
├──────────────────────────────────┤
│  [0 1 1]   [1 0 0]   [1 1 1]     │
│  [1 0 1] + [0 1 0] = [1 1 1]     │
│  [1 1 0]   [0 0 1]   [1 1 1]     │
└──────────────────────────────────┘
```

---

### Step 3: Compute Degree Matrix D

**Degree** = Sum of each row
```
D₁₁ = 1 + 1 + 1 = 3
D₂₂ = 1 + 1 + 1 = 3
D₃₃ = 1 + 1 + 1 = 3

┌──────────────────────┐
│  D (Degree Matrix)   │
├──────────────────────┤
│  [3  0  0]           │
│  [0  3  0]           │
│  [0  0  3]           │
└──────────────────────┘
```

---

### Step 4: Compute D^(-1/2)
```
D^(-1/2) = 1/√3 on diagonal

┌────────────────────────────────┐
│  D^(-1/2)                      │
├────────────────────────────────┤
│  [0.577   0      0    ]        │
│  [  0   0.577   0    ]        │
│  [  0     0   0.577  ]        │
└────────────────────────────────┘

(0.577 ≈ 1/√3 = 1/1.732)
```

---

### Step 5: Normalized Adjacency Ŵ* = D^(-1/2) W̃ D^(-1/2)

#### Step 5a: Compute D^(-1/2) W̃
```
D^(-1/2) W̃ = [0.577   0      0   ]   [1  1  1]
              [  0   0.577   0   ] × [1  1  1]
              [  0     0   0.577 ]   [1  1  1]

Row 1: [0.577×1, 0.577×1, 0.577×1] = [0.577, 0.577, 0.577]
Row 2: [0.577×1, 0.577×1, 0.577×1] = [0.577, 0.577, 0.577]
Row 3: [0.577×1, 0.577×1, 0.577×1] = [0.577, 0.577, 0.577]

Result = [0.577  0.577  0.577]
         [0.577  0.577  0.577]
         [0.577  0.577  0.577]
```

#### Step 5b: Compute (D^(-1/2) W̃) D^(-1/2)
```
[0.577  0.577  0.577]   [0.577   0      0   ]
[0.577  0.577  0.577] × [  0   0.577   0   ]
[0.577  0.577  0.577]   [  0     0   0.577 ]

Element (1,1): 0.577 × 0.577 = 0.333
Element (1,2): 0.577 × 0.577 = 0.333
Element (1,3): 0.577 × 0.577 = 0.333
... (all elements same)

┌────────────────────────────────────┐
│  Ŵ* (Normalized Adjacency Matrix)  │
├────────────────────────────────────┤
│  [0.333  0.333  0.333]             │
│  [0.333  0.333  0.333]             │
│  [0.333  0.333  0.333]             │
└────────────────────────────────────┘
```

---

### Step 6: Graph Convolution for Time Point t₁'

**Take first time column from X_tfem**:
```
X_t₁' = [-0.2]  ← Ch1
        [-1.4]  ← Ch2
        [ 2.1]  ← Ch3
```

**Compute Ŵ* × X_t₁'**:
```
[0.333  0.333  0.333]   [-0.2]
[0.333  0.333  0.333] × [-1.4]
[0.333  0.333  0.333]   [ 2.1]
```

**Row 1 Calculation**:
```
(0.333 × -0.2) + (0.333 × -1.4) + (0.333 × 2.1)
= -0.0666 - 0.4662 + 0.6993
= 0.1665
```

**Row 2 Calculation**:
```
Same as Row 1 = 0.1665
```

**Row 3 Calculation**:
```
Same as Row 1 = 0.1665
```

**Result**:
```
Ŵ* × X_t₁' = [0.167]  ← Aggregated Ch1
             [0.167]  ← Aggregated Ch2
             [0.167]  ← Aggregated Ch3
```

**Interpretation**: Each channel now contains information from ALL channels, weighted equally (0.333 each).

---

### Step 7: Repeat for Other Time Points

**For t₂'**: X_t₂' = [2.3, 0.9, -1.3]
```
Row calculation:
(0.333 × 2.3) + (0.333 × 0.9) + (0.333 × -1.3)
= 0.7659 + 0.2997 - 0.4329
= 0.6327

Ŵ* × X_t₂' = [0.633]
             [0.633]
             [0.633]
```

**For t₃'**: X_t₃' = [-1.4, 1.6, -0.7]
```
Row calculation:
(0.333 × -1.4) + (0.333 × 1.6) + (0.333 × -0.7)
= -0.4662 + 0.5328 - 0.2331
= -0.1665

Ŵ* × X_t₃' = [-0.167]
             [-0.167]
             [-0.167]
```

---

### Step 8: CARM Output (Before Learnable Transform Θ)
```
┌──────────────────────────────────────┐
│  H = After Graph Convolution         │
├──────────────────────────────────────┤
│       t₁'    t₂'    t₃'              │
│ Ch1 [0.167  0.633 -0.167]            │
│ Ch2 [0.167  0.633 -0.167]            │
│ Ch3 [0.167  0.633 -0.167]            │
└──────────────────────────────────────┘
```

**Key Observation**: All channels now have IDENTICAL values because initial Ŵ* is uniform.

---

## PART 3: LEARNABLE TEMPORAL TRANSFORM Θ

**Initialize Θ** (3×3 matrix):
```
┌──────────────────────┐
│  Θ (Learnable)       │
├──────────────────────┤
│  [ 0.8  -0.2   0.4]  │
│  [-0.3   0.6   0.1]  │
│  [ 0.5   0.2  -0.7]  │
└──────────────────────┘
```

### Compute H × Θ (for Channel 1):

**Input row**: [0.167, 0.633, -0.167]

**Output position 1**:
```
(0.167 × 0.8) + (0.633 × -0.3) + (-0.167 × 0.5)
= 0.1336 - 0.1899 - 0.0835
= -0.1398
```

**Output position 2**:
```
(0.167 × -0.2) + (0.633 × 0.6) + (-0.167 × 0.2)
= -0.0334 + 0.3798 - 0.0334
= 0.3130
```

**Output position 3**:
```
(0.167 × 0.4) + (0.633 × 0.1) + (-0.167 × -0.7)
= 0.0668 + 0.0633 + 0.1169
= 0.2470
```

**Channel 1 output**: [-0.140, 0.313, 0.247]

Since all channels have same H values, **all outputs are identical**.

---

## FINAL CARM OUTPUT:
```
┌──────────────────────────────────────┐
│  H_final = After Θ Transform         │
├──────────────────────────────────────┤
│       t₁''   t₂''   t₃''             │
│ Ch1 [-0.140  0.313  0.247]           │
│ Ch2 [-0.140  0.313  0.247]           │
│ Ch3 [-0.140  0.313  0.247]           │
└──────────────────────────────────────┘
```

---

## PART 4: BACKPROPAGATION UPDATE

### Assume Loss = 2.5 and computed gradients:
```
∂Loss/∂Ŵ* = [-0.6   0.4   0.2]
            [ 0.3  -0.5   0.1]
            [ 0.2   0.1  -0.8]
```

### Update Rule (ρ = 0.001):
```
Ŵ*_new = (1 - 0.001) × Ŵ*_old - 0.001 × ∂Loss/∂Ŵ*
```

**Element (1,1)**:
```
0.999 × 0.333 - 0.001 × (-0.6)
= 0.332667 + 0.0006
= 0.333267
```

**Element (1,2)**:
```
0.999 × 0.333 - 0.001 × 0.4
= 0.332667 - 0.0004
= 0.332267
```

**Element (1,3)**:
```
0.999 × 0.333 - 0.001 × 0.2
= 0.332667 - 0.0002
= 0.332467
```

**Element (2,1)**:
```
0.999 × 0.333 - 0.001 × 0.3
= 0.332667 - 0.0003
= 0.332367
```

**Element (2,2)**:
```
0.999 × 0.333 - 0.001 × (-0.5)
= 0.332667 + 0.0005
= 0.333167
```

**Element (2,3)**:
```
0.999 × 0.333 - 0.001 × 0.1
= 0.332667 - 0.0001
= 0.332567
```

**Element (3,1)**:
```
0.999 × 0.333 - 0.001 × 0.2
= 0.332667 - 0.0002
= 0.332467
```

**Element (3,2)**:
```
0.999 × 0.333 - 0.001 × 0.1
= 0.332667 - 0.0001
= 0.332567
```

**Element (3,3)**:
```
0.999 × 0.333 - 0.001 × (-0.8)
= 0.332667 + 0.0008
= 0.333467
```

---

## UPDATED ADJACENCY MATRIX:
```
┌────────────────────────────────────────┐
│  Ŵ*_new (After 1 Iteration)            │
├────────────────────────────────────────┤
│  [0.3333  0.3323  0.3325]              │
│  [0.3324  0.3332  0.3326]              │
│  [0.3325  0.3326  0.3335]              │
└────────────────────────────────────────┘
```

**Key Changes**:
- Ch1↔Ch1: **0.333 → 0.3333** (strengthened)
- Ch1↔Ch2: **0.333 → 0.3323** (weakened)
- Ch3↔Ch3: **0.333 → 0.3335** (strengthened most)

---

## SUMMARY OF COMPLETE PIPELINE:
```
INPUT (3×4)           TFEM            X_tfem (3×3)
┌──────────┐      ┌─────────┐      ┌──────────┐
│ 2  4 -1 3│      │  Conv   │      │-0.2  2.3 │
│-1  3  2-2│  →   │  k=2    │  →   │-1.4  0.9 │
│ 3 -2  1 4│      │stride=1 │      │ 2.1 -1.3 │
└──────────┘      └─────────┘      └──────────┘

       ↓
    
     CARM               H (3×3)          Θ Transform
┌─────────────┐      ┌──────────┐      ┌──────────┐
│ Ŵ* = 0.333  │      │ 0.167... │      │-0.14 0.31│
│ (adaptive)  │  →   │ 0.633... │  →   │-0.14 0.31│
│ learns!     │      │-0.167... │      │-0.14 0.31│
└─────────────┘      └──────────┘      └──────────┘
                                            ↓
                                      FINAL OUTPUT
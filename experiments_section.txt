---PAGE 6---
SUN et al.: GRAPH CONVOLUTION NEURAL NETWORK BASED END-TO-END CHANNEL SELECTION AND CLASSIFICATION 9319
where di is the ith entry in the leading diagonal of the degree
matrix. Therefore, the nodes with large τ values, representing
the channels carrying more information, will be selected in AS
method.
III. EXPERIMENTS AND RESULTS
A. Experimental Protocol and Data Preprocessing
TJU dataset: Experiments were conducted with 25 right-
handed students (12 men and 13 women) at Tianjin University,
their average age is 25.3 years (range, 19–32). None of them
have personal or family history of neurological illness. Besides,
participants were asked not to take psychotropic drugs two days
before the experiment and to get at least 7 h of sleep the night
before the experiment to avoid interference with the experiment.
All procedures for recording experiments were approved by the
China Rehabilitation Research Center Ethics Committee (No.
CRRC-IEC-RF-SC-005-01). The EEG signals were acquired
using the Neuroscan system, which consists of 64 Ag/AgCl scalp
electrodes arranged according to the 10/20 system. The sampling
frequency is set at 1000 Hz and can be downsampled during
the preprocessing phase. Before the experiment, the electrode
impedance would be tuned to below 5 k Ω through injecting
conductive gel. Two of the 64 electrodes are used to detect all
eye movements, and two are deﬁned as reference electrodes.
Subjects are asked to remain as still as possible throughout
the experiment to avoid affecting with other movements or
brain activity during experiment. During the preprocessing, the
EEGLAB toolbox [32] was used to perform artifact correction,
baseline correction, artifact removal, and common average ref-
erencing of the EEG data. The sampling frequency was reduced
to 128 Hz and the EEG signal was bandpass-ﬁltered at 0.5–50 Hz
to eliminate powerline interference at 50 Hz and physiological
noise at high frequencies. Then, the components closely related
to EOG would be identiﬁed and removed by independent com-
ponent analysis (ICA). Preprocessed EEG data containing 60
channels would be divided into nonoverlapping 4-s samples.
Each subject participated in 320 trials, which included 160 trials
involving right-hand imagery movements and 160 trials of foot
imagery movements.
BCICIV 2a dataset [33]:The BCICIV 2a dataset collects EEG
signals of 22 nodes recorded from nine healthy subjects. For
each subject, two session of data are collected on two different
days. Each session is comprised of 288 MI trials per subject.
The signals were sampled with 250 Hz and bandpass-ﬁltered
between 0.5 and 100 Hz by the dataset provider before release.
In our experiment, considering the fairness of comparison, left-
hand movement, and right-hand movement are included in the
dataset to validate the performance of the model, which results
in 288 trials (144 trials ×2 sessions) per subject. The sampling
rate was reduced to 128 Hz with 4 s resulting in 512 time points.
PhysioNet dataset [34]:The PhysioNet dataset contains EEG
data collected from 109 healthy subjects who are asked to
imagine the open and close of the left/right ﬁst with 64 channels
and a sampling rate of 160 Hz. However, due to the damaged
recordings with multiple consecutive “rest” sections, the data
of subject #88, #89, #92, #100 are removed. Thus, in this
experiment, we have EEG data from 105 subjects, each pro-
viding approximately 43 trials, with a roughly balanced ratio
of binary task. Each trial consist of 3.2 s, resulting in 512 time
points. We do not perform any additional preprocessing on the
EEG data.
B. Baselines and Comparison Criteria
The computer hardware resources used in this article include
NVIDIA Titan Xp GPU and Intel Core I7 CPU. The proposed
model is built and evaluated in PyTorch [35] and python 3.5
environments. For TJU and BCICIV 2a datasets, the data of
each subject are used to train and evaluate the performance of
the model separately. 10-fold cross-validation is applied to the
tests of each model, and the trials are randomly divided into 10
equal-size parts. A total of nine parts are used as the training set
and the remaining one part is used as the test set. The average
of the classiﬁcation accuracy of the 10 model test set is used as
the ﬁnal accuracy. For PhysioNet dataset, the data partitioning
is consistent with [19], ten of the 105 subjects are randomly
chosen as the test set and the rest as the training set. We run the
experiments 10 times and report the averaged results.
A total of ﬁve baselines are chosen to evaluate the perfor-
mance metrics of classiﬁcation accuracy with the proposed
EEG-ARNN, including FBCSP [36], CNN-SAE [9], EEG-
Net [10], ACS-SE-CNN [11], and graph-based G-CRAM [19].
To ensure the reliability of our experiments, we set the batch
size to 20 for 500 epochs in the following methods with deep
learning. We use Adam optimizer with a learning rate of 0.001.
The drop out rate is set to 0.25.
C. Classiﬁcation Performance Comparisons
To evaluate the proposed EEG-ARNN, we ﬁrst perform
FBCSP, CNN-SAE, EEGNet, ACS-SE-CNN, G-CRAM, EEG-
ARNN on TJU datasets of 25 subjects in sequence. The ex-
perimental results are shown in Table I. The average results
of the six methods above are 67.5%, 74.7%, 84.9%, 87.2%,
71.5%, 92.3%. It is observed that the EEG-ARNN provides a
24.8% improvement concerning FBCSP, a 17.4% improvement
to CNN-ASE in terms of average accuracy. Compared with
these two methods, the improvement effect is signiﬁcant. As for
EEGNet and ACE-SE-CNN, the average accuracy improvement
in EEG-ARNN is 7.4%, 5.1%. Compared with the graph-based
G-CRAM method, our average accuracy improves by 17.2%.
G-CRAM is designed to handle the cross-subject datasets, so
the dataset size of a single subject limits the performance of
G-CRAM. It is also proved that our method can deal with
small datasets. Moreover, the average standard deviation (std)
of 10-fold cross-validation accuracies for EEG-ARNN is 3.0%,
which is less than that of FBCSP (std =7.9%), EEGNet (std =
5.0%), CNN-SAE (std = 5.7%), ACE-SE-CNN (std = 5.0%),
G-CRAM (std = 3.9%), thus proves that EEG-ARNN is quite
robust in EEG recordings. Table I also illustrates the F1-score
result, which indicates that the proposed model outperforms
other methods. In addition, EEG-ARNN outperforms FBCSP,
EEGNet, and CNN-SAE in all 25 subjects. It also performs
better in 24 out of 25 subjects compared with ACS-SE-CNN---PAGE 7---
9320 IEEE TRANSACTIONS ON INDUSTRIAL INFORMATICS, VOL. 19, NO. 9, SEPTEMBER 2023
TABLE I
CLASSIFICA TIONACCURACY (%), STA N DA R DDEVIA TION(STD), AND F1-SCORE (%) RESULTS ONTJU DA T ASET
Fig. 3. Mean classiﬁcation performance (%) of each algorithm aver-
aged across all 25 subjects from the TJU dataset. *** and * above certain
lines denote that the performance of EEG-ARNN was signiﬁcantly better
than that of the corresponding algorithm at the 0.005 and 0.1 level.
and G-CRAM. Moreover, statistical signiﬁcance is assessed
by Wilcoxon signed-rank test for each algorithm with EEG-
ARNN as shown in Fig. 3. The results show that EEG-ARNN
dominates among all algorithms in terms of average accuracy.
The differences are signiﬁcant except for EEG-ARNN versus
ACE-SE-CNN, the EEG-ARNN performs slightly better than
ACS-SE-CNN.
We also validate the performance of our proposed method
on two widely used public datasets. Tables II and III illustrate
the classiﬁcation accuracy, standard deviation, and F1-score
results of proposed and baseline methods on BCICIV 2a and
PhysioNet dataset, respectively. It can be observed that the
overall performance of our EEG-ARNN is also competitive on
public datasets. For BCICIV 2a dataset, the average classiﬁca-
tion accuracy outperforms all other baseline methods, includ-
ing traditional method, CNN-based methods, and graph-based
method as well as the classiﬁcation accuracy and F1-score of
more than two-thirds of subjects on EEG-ARNN are higher than
other baselines. For PhysioNet dataset, as shown in Table III,
the proposed method achieves the highest average accuracy and
F1-score among all baseline methods. Furthermore, the average
standard deviation of EEG-ARNN is lower than 4 of 5 baseline
models in nine replicates. These indicate that our proposed
method is also competitive on cross-subjects datasets.
D. Ablation Experiments
In this section, ablation experiments were conducted to iden-
tify the contribution of key components of the proposed method
(the part inside the black dashed line in Fig. 1), the training
method and parameter settings for the ablation experiments
remained the same as those in Section III-B.
We considered three cases on TJU dataset, i.e., retaining
TFEM or CARM only, using different number of TFEM-CARM
blocks, switching the sequence of TFEM and CARM. The aver-
age classiﬁcation accuracies, standard deviation, and F1-score in
three cases for all subjects are illustrated in Table IV. The accura-
cies of the EEG-ARNN without CARM or TFEM decrease a lot
compared to the proposed method. When the CARM is removed,
the model loses the update mechanism on ˆW
∗ and the ability to
make active reasoning about channel connectivity relations. The
average accuracy of EEG-ARNN is 92.3% ±3.0%, indicating
7.0% improvements compared to the model with TFEM only. On
the other hand, when the TFEM is removed, the ability to extract
temporal feature is excluded from the proposed method. It has an
accuracy of 75.4% ±5.1%, a decrease of 16.9% compared to the
EEG-ARNN. To explore the optimal structure of the network,
we evaluate the differences in results obtained using different
number of TFEM-CARM blocks. Note that the model with i
blocks is named as TFEM-CARM ×i, where i = 1,2,3. It can---PAGE 8---
SUN et al.: GRAPH CONVOLUTION NEURAL NETWORK BASED END-TO-END CHANNEL SELECTION AND CLASSIFICATION 9321
TABLE II
CLASSIFICA TIONACCURACY (%), STA N DA R DDEVIA TION(STD) AND F1-SCORE (%) RESULTS ONBCICIV 2A
TABLE III
CLASSIFICA TIONACCURACY (%), STA N DA R DDEVIA TION(STD), AND
F1-SCORE(%) RESULTS ONPHYSIONET DA T ASET
TABLE IV
MEAN CLASSIFICA TIONACCURACY (%), STA N DA R DDEVIA TION(STD), AND
F1-SCORE(%) RESULTS FORABLA TIONEXPERIMENTS ON TJU DA T ASET
be observed that even if one block is applied, the accuracy is
3.7% and 13.6% higher than the model only with TFEM and
CARM, respectively. In addition, if we switch the order of
TFEM and CARM (term as CARM-TFEM × 3), the accuracy
drops to 75.6%, which is even lower than the model with one
TFEM-CARM block.
Therefore, singular temporal or spatial feature is insufﬁcient
to describe complex physiological activities, and fewer TFEM-
CARM blocks are not enough to extract effective spatiotemporal
feature. Furthermore, the advantage of using TFEM and CARM
alternately is to guarantee that corresponding spatiotemporal
features can be extracted from the feature map at various scales,
due to the fact that the neural activities of different subjects
often exhibit diversiﬁed spatiotemporal interactions. The result
of ablation experiments demonstrates that our EEG-ARNN is
a preferable model to comprehensively leverage spatiotemporal
feature for MI classiﬁcation task.
E. Results of ES and AS
In order to further generalize the model, we use the trained
ˆW
∗ to select the most important channels for BCI classiﬁca-
tion. The data obtained by channel reduction using ES and AS
mentioned in Section II-D are retrained in EEG-ARNN. For this
TABLE V
CLASSIFICA TIONACCURACY (%) AND STA N DA R DDEVIA TION(STD)R ESULTS
FOR ES AND AS IN ARNN AND CNN PROPOSED
experiment, we set four different stages (top k) using ES and
AS, where k = 10,20,30,40. Speciﬁcally, the EEG channels
with the highest weight of k edges are selected by ES, and
the k highest weighted EEG nodes are selected by the edge
information aggregation capability of AS. All parameters are
kept constant except for the channel of the input data to maintain
the consistency of the experiment. To verify the effectiveness of
the method, we also test the ES and AS using the network only
with TFEM (term as CNN).
The results of AS method are shown in Table V. We observe
that when the number of channels is reduced to 10, the average
accuracy of the results is 87 .9%±4.3%, which is a decrease of
4.4% compared to 60 channels data. Considering that only 10
channels are retained, the decrease is still within an acceptable
range. As the number of channels increases to 20, 30, and 40, the
accuracy increases to 89 .3%±3.6%,8 9.8%±3.6%,8 9.7%±
3.7%, a decrease of less than 3% compared to the 60 channels
data, and it can be observed that the change in accuracies is not
signiﬁcant when the number of channels exceeds 20.
For the ES method, the average accuracy is 88 .0%±3.9%
when the 10 highest weighted edges are selected. The accuracy
increases to 90 .0%±3.9% when 20 edges are selected. When
the number of selected edges reaches 30, the accuracy does
not change signiﬁcantly (90 .2%±3.5%). When 40 edges are
selected, the accuracy also remains at 90.2
%±3.4%. The degra-
dation of classiﬁcation performance was not signiﬁcant when
comparing the four sets of experiments with channel selection
to the full channel data experiments. Using EEG-ARNN, the
average accuracy obtained with the 10 channels selected using
the AS method is only 4.4% lower than that obtained with the full
channels, still higher than the ﬁve baselines in Table I. Moreover,
the amount of data is only 1/6 of the original data, implying
that the channel selection process is important to save subjects’
acquisition time and reduce the complexity of BCI experiments.---PAGE 9---
9322 IEEE TRANSACTIONS ON INDUSTRIAL INFORMATICS, VOL. 19, NO. 9, SEPTEMBER 2023
Fig. 4. Frequency and distribution of channels selected by ES/AS
method among 25 subjects in TJU dataset. (a) Most frequency channel
selected by ES. (b) Most frequency channel selected by. (c) Distribution
of channels selected by ES. (d) Distribution of channels selected by AS.
AS method is a node-based selection method, which is a
direct channel selection method. AS selects the number of
channels equal to the speciﬁed value k. In contrast, ES is an
indirect edge-based channel selection method. It selects the node
corresponding to the largest edge of the group k at both ends,
so the maximum number of nodes that may be selected is 2 k.
However, since the activation regions of the brain are always
similar under the ﬁxed paradigm, leading to the case where a
node is contained by several edges. In this case, we ﬁnd that
fewer than k nodes are selected by ES. With similar impact on
classiﬁcation accuracy, ES has less computational burden than
AS, so ES is considered as a more efﬁcient method.
F . Relation Between ES/AS and Neurology
To reveal which channel plays a major role in the EEG
acquisition process and to explore the relationship between the
brain region where the channel is located and the MI experiment,
two ways to select the channels is designed in Section II-D, we
further investigate what the EEG channels selected using ES and
AS can indicate and whether the structures shown in Figs. 4 and
5 can match neurology concept. We ﬁrst extracted the channels
obtained from the top20 experiments of 25 subjects in the TJU
dataset, and listed the channels selected more frequently by ES
and AS methods in Fig. 4(a) and (c).F i g . 4(b) and (d) exhibit
the distribution of these channels in scalp electrodes. It can be
seen that “C1,” “C3,” “CZ,” “CP1,” “CP3” and other electrodes
related to motor imagination are selected several times by the
two methods, and some electrodes are chosen in more than
two-thirds of the subjects, which indicates that the channel se-
lection methods proposed have neurophysiological signiﬁcance.
Then, the edges/nodes structures of two subjects are selected
and plotted using brainnetviewer [37]. According to Table I,
it can be obtained that the data of the No.17 subject achieves
excellent results on the six different classiﬁers. However, the
No.23 subject has poor data quality. Based on this premise, we
selected the 20 edges and 20 nodes with the highest weights
following the method of Section II-D.
TABLE VI
CLASSIFICA TIONACCURACY (%) AND STA N DA R DDEVIA TION(STD)R ESULTS
FOR NO.17 AND NO.23 IN TOP20 ESAND AS USING EEG-ARNN
AND CNN
A ss h o w ni nF i g .5(a), the selected edges in No.17 subject are
mainly in the left hemisphere, and the most frequent channels are
“CP3,” followed by “CP1,” “CZ,” and other channels. Human
high-level senses (e.g., somatosensory, spatial sensation) are
mainly performed by the parietal lobe, and electrode “CP3” is
located in the parietal lobe. In the MI experiment, subjects did
not produce actual movements, but only imagined movements
based on cues on the screen, which required the sensation of
movement. The electrode “CP3” is located in the parietal lobe,
which is responsible for this sensation. For the AS selected
channels shown in Fig. 5(c), the channel locations are similar
to that of the channels selected using ES, with the channels
mainly distributed in the left hemisphere. It is worth noting that
ES selects the edge with the largest weight and then selects the
EEG channels located on both sides of the edge. Therefore, the
number of EEG channels selected by ES is usually less than
the number of EEG channels selected by AS. For the No.17
subject, 20 nodes were selected using AS, while 11 nodes were
selected using ES, but the corresponding accuracy decreased by
only 0.3%, as shown in Table VI.
The channel connections of No.23 subject are shown in
Fig. 5(b), with more channels located in the right hemisphere,
except for the “CP3” channel, which still plays a important role.
In contrast, No.17 subject selects 11 channels, which means
that the distribution of channels of No.23 is more dispersed.
The EEG channels selected using AS shows the same proper-
ties in Fig. 5(d), with channels mostly distributed in the right
hemisphere, while a few related to the sensation of movement
channels such as “FC5” and “PO3” are also selected. “C”-series
channels (CZ, C1, C2,...) are mainly located in the precentral
gyrus, and the neurons in this part are primarily responsible
for human movements. It is obvious that most of the channels
with high weights are “C”-series for No.17 subject. However, the
distribution of the channels with a higher weight of No.23 subject
is disorderly. The mean accuracies of No.17 and No.23 subjects
are shown in Table VI. This further reveals the relationship
between the selected channels of the ES/AS obtained through
EEG-ARNN and the subjects performing the MI experiment.
During the MI experiment, No.17 subject was energetically fo-
cused during the experiment, while No.23 subject had problems
such as lack of concentration during the imagery. It can be
conﬁrmed that the vital feature of the MI is captured through
the EEG-ARNN. It also demonstrates the importance of the
EEG-ARNN proposed in revealing the working state of different
brain regions of the subjects.